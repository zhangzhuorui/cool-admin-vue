import{u as e}from"./index-D3YIdvZh.js";import"./store@2.0.12-BfN7CKDu.js";import{u as s,c as t}from"./comm-D8jqGG-6.js";import{E as r,a as o}from"./element-plus@2.10.2_vue@3.5.18_typescript@5.5.4_-C0B857f5.js";import{d as i,e as p,A as l,E as a,N as m,o as n,O as u,m as c,D as _,R as d}from"./@vue_runtime-core@3.5.18-Bx_iA1Ob.js";import{u as j}from"./vue-i18n@11.1.10_vue@3.5.18_typescript@5.5.4_-CsgNkmMV.js";import{v as f,y as v}from"./@vue_reactivity@3.5.18-BEjiziYi.js";import{P as h}from"./@vue_shared@3.5.18-BWKBh1Qo.js";import"./@vue_runtime-dom@3.5.18-D95plCo_.js";import"./@vueuse_core@12.8.2_typescript@5.5.4-CyTP3PVf.js";import"./@vueuse_shared@12.8.2_typescript@5.5.4-B6jvMh_s.js";import"./lodash-es@4.17.21-DuLBTDIG.js";import"./mitt@3.0.1-BeZB7Ik_.js";import"./pinia@2.3.1_typescript@5.5.4_vue@3.5.18_typescript@5.5.4_-DPB-daMN.js";import"./vue-router@4.5.1_vue@3.5.18_typescript@5.5.4_-LCN95BWb.js";import"./vue-echarts@7.0.3_@vue_runtime-core@3.5.18_echarts@5.6.0_vue@3.5.18_typescript@5.5.4_-He2CYVXX.js";import"./echarts@5.6.0-D5a_RdwN.js";import"./tslib@2.3.0-ZseNXxlj.js";import"./zrender@5.6.1-BkMfNy7l.js";import"./axios@1.11.0-C-1G2k3o.js";import"./nprogress@0.2.0-Sg3Wh2FH.js";import"./chardet@2.1.0-B0E1a5C9.js";import"./@vueuse_shared@9.13.0_vue@3.5.18_typescript@5.5.4_-DyKSiD-b.js";import"./@vueuse_core@9.13.0_vue@3.5.18_typescript@5.5.4_-CQVfZnDR.js";import"./@element-plus_icons-vue@2.3.1_vue@3.5.18_typescript@5.5.4_-3DUFfuWD.js";import"./@sxzz_popperjs-es@2.11.7-CT_jBSb5.js";import"./@ctrl_tinycolor@3.6.1-D2oWfImC.js";import"./dayjs@1.11.13-DxKHiy_y.js";import"./async-validator@4.2.5-j0i5Y79Y.js";import"./memoize-one@6.0.0-BAtLgO95.js";import"./normalize-wheel-es@1.2.0-TzhA1irr.js";import"./@floating-ui_dom@1.7.2-CHufsicy.js";import"./@floating-ui_core@1.7.2-DWnBSKmT.js";import"./@floating-ui_utils@0.2.10-QZXVpxRV.js";import"./element-plus@2.10.4_vue@3.5.18_typescript@5.5.4_-BKZsM6nW.js";import"./@intlify_core-base@11.1.10-C1bgUhoS.js";import"./@intlify_shared@11.1.10-BEv--mwN.js";import"./@intlify_message-compiler@11.1.10-JI08Nz38.js";const y=i({name:"undefined"}),b=i({...y,name:"sys-log",setup(i){const{service:y}=e(),{t:b}=j(),g=f(1),x=s({service:y.base.sys.log},e=>{e.refresh()}),w=t({contextMenu:["refresh"],columns:[{type:"index",label:"#",width:60},{prop:"userId",label:b("用户ID"),minWidth:100},{prop:"name",label:b("用户昵称"),minWidth:120},{prop:"action",label:b("请求地址"),minWidth:200,showOverflowTooltip:!0},{prop:"params",label:b("参数"),minWidth:200,component:{name:"cl-code-json",props:{popover:!0}}},{prop:"ip",label:"ip",minWidth:150,dict:[],dictColor:!0,formatter:e=>e.ip.split(",")},{prop:"createTime",label:b("请求时间"),minWidth:170,sortable:"desc"}]});function W(){y.base.sys.log.setKeep({value:g.value}).then(()=>{r.success(b("保存成功"))}).catch(e=>{r.error(e.message)})}function z(){o.confirm(b("是否要清空日志？"),b("提示"),{type:"warning"}).then(()=>{y.base.sys.log.clear().then(()=>{var e;r.success(b("清空成功")),null==(e=x.value)||e.refresh()}).catch(e=>{r.error(e.message)})}).catch(()=>null)}return p(()=>{y.base.sys.log.getKeep().then(e=>{g.value=Number(e)})}),(e,s)=>{const t=l("cl-refresh-btn"),r=l("el-button"),o=l("el-input-number"),i=l("cl-filter"),p=l("cl-flex1"),j=l("cl-search-key"),f=l("cl-row"),b=l("cl-table"),C=l("cl-pagination"),k=l("cl-crud"),D=a("permission");return n(),m(k,{ref_key:"Crud",ref:x},{default:u(()=>[c(f,null,{default:u(()=>[c(t),_((n(),m(r,{type:"danger",onClick:z},{default:u(()=>[d(h(e.$t("清空")),1)]),_:1})),[[D,v(y).base.sys.log.permission.clear]]),c(i,{label:e.$t("日志保存天数")},{default:u(()=>[c(o,{modelValue:g.value,"onUpdate:modelValue":s[0]||(s[0]=e=>g.value=e),"controls-position":"right",max:1e4,min:1,onChange:W},null,8,["modelValue"])]),_:1},8,["label"]),c(p),c(j,{placeholder:e.$t("搜索请求地址、用户昵称、ip")},null,8,["placeholder"])]),_:1}),c(f,null,{default:u(()=>[c(b,{ref_key:"Table",ref:w},null,512)]),_:1}),c(f,null,{default:u(()=>[c(p),c(C)]),_:1})]),_:1},512)}}});export{b as default};
