import{e,c as l,u as r}from"./comm-D8jqGG-6.js";import{u as t,g as o,P as a}from"./index-D3YIdvZh.js";import"./store@2.0.12-BfN7CKDu.js";import{u as n}from"./group-CbWLsH0h.js";import{d as p,A as i,N as d,o as s,O as u,m,a as c,R as f}from"./@vue_runtime-core@3.5.18-Bx_iA1Ob.js";import{u as v}from"./vue-i18n@11.1.10_vue@3.5.18_typescript@5.5.4_-CsgNkmMV.js";import{P as b}from"./@vue_shared@3.5.18-BWKBh1Qo.js";const h=p({name:"undefined"}),y=p({...h,name:"dict-list",setup(p){const{service:h}=t(),{dict:y}=o(),{t:_}=v(),{ViewGroup:x}=n({label:_("类型"),title:_("字典列表"),service:h.dict.type,onSelect(e){var l,r;l={typeId:e.id,page:1,prop:"orderNum",order:"desc"},null==(r=g.value)||r.refresh(l)},onEdit:()=>({width:"500px",props:{labelWidth:"60px"},items:[{label:_("名称"),prop:"name",component:{name:"el-input",props:{maxlength:20}},required:!0},{label:"Key",prop:"key",component:{name:"el-input",props:{maxlength:20}},required:!0}]})}),w=e({dialog:{width:"600px"},props:{labelWidth:"100px"},items:[{label:_("上级节点"),prop:"parentId",component:{name:"cl-select",props:{labelKey:"name",valueKey:"id",checkStrictly:!0,tree:!0,current:!0,defaultExpandAll:!0}}},{label:_("名称"),prop:"name",required:!0,component:{name:"el-input"}},{label:_("值"),prop:"value",component:{name:"slot-value"}},{label:_("排序"),prop:"orderNum",value:1,component:{name:"el-input-number",props:{min:1}}},{label:_("备注"),prop:"remark",component:{name:"el-input",props:{type:"textarea",rows:4}}}],onSubmit(e,{next:l}){var r,t;l({...e,typeId:null==(t=null==(r=x.value)?void 0:r.selected)?void 0:t.id})},plugins:[a.Form.setFocus("name")]}),k=l({contextMenu:["refresh",e=>{var l;return{label:_("新增"),hidden:!(null==(l=h.dict.info._permission)?void 0:l.add),callback(l){W(e),l()}}},"edit","delete","order-asc","order-desc"],columns:[{type:"selection"},{label:_("名称"),prop:"name",align:"left",minWidth:200},{label:_("ID"),prop:"id",minWidth:120},{label:_("值"),prop:"value",minWidth:200,showOverflowTooltip:!0},{label:_("备注"),prop:"remark",showOverflowTooltip:!0,minWidth:170},{label:_("排序"),prop:"orderNum",sortable:"desc",width:100,fixed:"right"},{label:_("创建时间"),prop:"createTime",sortable:"custom",minWidth:170},{label:_("更新时间"),prop:"updateTime",sortable:"custom",minWidth:170},{type:"op",width:250,buttons:[{label:_("新增"),type:"success",hidden:!h.dict.info._permission.add,onClick({scope:e}){W(e.row)}},"edit","delete"]}],plugins:[a.Table.toTree()]}),g=r({service:h.dict.info,onRefresh(e,{render:l}){h.dict.info.list(e).then(e=>{var r,t;l(e),y.refresh([null==(t=null==(r=x.value)?void 0:r.selected)?void 0:t.key])})}});function W(e){var l;null==(l=g.value)||l.rowAppend({parentId:e.id,orderNum:1})}function j(e){var l,r;null==(r=w.value)||r.setForm("value",null==(l=e[0])?void 0:l.url)}return(e,l)=>{const r=i("cl-refresh-btn"),t=i("cl-add-btn"),o=i("cl-multi-delete-btn"),a=i("cl-flex1"),n=i("cl-search-key"),p=i("cl-row"),v=i("cl-table"),h=i("el-input"),y=i("cl-upload-space"),_=i("cl-upsert"),W=i("cl-crud"),T=i("cl-view-group");return s(),d(T,{ref_key:"ViewGroup",ref:x},{"item-name":u(({item:e})=>[f(b(e.name)+" - "+b(e.key),1)]),right:u(()=>[m(W,{ref_key:"Crud",ref:g},{default:u(()=>[m(p,null,{default:u(()=>[m(r),m(t),m(o),m(a),m(n,{placeholder:e.$t("搜索名称")},null,8,["placeholder"])]),_:1}),m(p,null,{default:u(()=>[m(v,{ref_key:"Table",ref:k},null,512)]),_:1}),m(p,null,{default:u(()=>[m(a)]),_:1}),m(_,{ref_key:"Upsert",ref:w},{"slot-value":u(({scope:l})=>[c("div",null,[m(h,{modelValue:l.value,"onUpdate:modelValue":e=>l.value=e,placeholder:e.$t("请填写值"),clearable:"",type:"textarea",rows:4,class:"mb-2"},null,8,["modelValue","onUpdate:modelValue","placeholder"]),m(y,{text:e.$t("使用文件"),limit:1,onConfirm:j},null,8,["text"])])]),_:1},512)]),_:1},512)]),_:1},512)}}});export{y as _};
