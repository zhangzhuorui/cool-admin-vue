import{k as e,m as a,j as s}from"./index-D3YIdvZh.js";import"./store@2.0.12-BfN7CKDu.js";import{E as t}from"./element-plus@2.10.2_vue@3.5.18_typescript@5.5.4_-C0B857f5.js";import{x as r}from"./lodash-es@4.17.21-DuLBTDIG.js";import{d as n,e as o,f as i,c as d,o as m}from"./@vue_runtime-core@3.5.18-Bx_iA1Ob.js";import{v as p,y as u}from"./@vue_reactivity@3.5.18-BEjiziYi.js";import{p as l}from"./@vue_shared@3.5.18-BWKBh1Qo.js";import{_ as c}from"./_plugin-vue_export-helper-BCo6x5W8.js";function v(){async function a(a){const s=(await e.base.sys.menu.list()).find(e=>e.router==a);s&&await e.base.sys.menu.delete({ids:[s.id]})}return{del:a,create:function(s){return new Promise(async(r,n)=>{var o;s.viewPath=`modules/${s.module}/views${null==(o=s.router)?void 0:o.replace(`/${s.module}`,"")}.vue`,await a(s.router),e.base.sys.menu.add({type:1,isShow:!0,keepAlive:!0,...s,api:void 0,code:void 0}).then(a=>{var t;const n=null==(t=s.api)?void 0:t.map(e=>{var t;const r={type:2,parentId:a.id,name:e.summary||e.path,perms:[e.path]};return"/update"==e.path&&(null==(t=s.api)?void 0:t.find(e=>"/info"==e.path))&&r.perms.push("/info"),{...r,perms:r.perms.map(e=>{var a;return((null==(a=s.prefix)?void 0:a.replace("/admin/",""))+e).replace(/\//g,":")}).join(",")}});e.base.sys.menu.add(n).then(()=>{r(()=>{e.request({url:"/__cool_createFile",method:"POST",proxy:!1,data:{code:s.code,path:s.viewPath}}).then(()=>{location.reload()})})})}).catch(e=>{t.error(e.message),n()})})}}}const f=["src"],h=n({name:"undefined"}),w=c(n({...h,name:"ai-code-dev",props:{path:String,hide:Boolean},emits:["message"],setup(e,{expose:t,emit:n}){const c=n,v=a.config("helper"),h=p(null),w=new Map;function y(e){try{const{name:a,data:s}=r(e.data)?JSON.parse(e.data):e.data,t=w.get(a);t&&t(s),c("message",{name:a,data:s})}catch(a){}}return o(()=>{window.addEventListener("message",y)}),i(()=>{window.removeEventListener("message",y)}),t({send:function(e,a,s){var t,r;s&&w.set(e,s),null==(r=null==(t=h.value)?void 0:t.contentWindow)||r.postMessage({name:e,data:a},"*")}}),(a,t)=>(m(),d("iframe",{src:`${u(v).index}${e.path}?lang=${u(s).serviceLang}`,class:l(["iframe",{"is-hide":e.hide}]),ref_key:"iframeRef",ref:h},null,10,f))}}),[["__scopeId","data-v-c0606011"]]);export{w as A,v as u};
