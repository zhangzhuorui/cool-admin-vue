import{u as e,d as l}from"./comm-D8jqGG-6.js";import{u as t,p as a,e as r}from"./index-D3YIdvZh.js";import{C as s}from"./index-l1IOnGdE.js";import{e as i,x as o,D as u,A as p}from"./lodash-es@4.17.21-DuLBTDIG.js";import{d as n,v as d,G as c,e as m,I as v,m as _,A as f}from"./@vue_runtime-core@3.5.18-Bx_iA1Ob.js";import{u as j}from"./vue-i18n@11.1.10_vue@3.5.18_typescript@5.5.4_-CsgNkmMV.js";import{v as h,z as y}from"./@vue_reactivity@3.5.18-BEjiziYi.js";import"./@vue_runtime-dom@3.5.18-D95plCo_.js";import"./@vue_shared@3.5.18-BWKBh1Qo.js";import"./@element-plus_icons-vue@2.3.1_vue@3.5.18_typescript@5.5.4_-3DUFfuWD.js";import"./element-plus@2.10.4_vue@3.5.18_typescript@5.5.4_-BKZsM6nW.js";import"./dayjs@1.11.13-DxKHiy_y.js";import"./chardet@2.1.0-B0E1a5C9.js";import"./normalize-wheel-es@1.2.0-TzhA1irr.js";import"./@vueuse_core@9.13.0_vue@3.5.18_typescript@5.5.4_-CQVfZnDR.js";import"./@vueuse_shared@9.13.0_vue@3.5.18_typescript@5.5.4_-DyKSiD-b.js";import"./@ctrl_tinycolor@3.6.1-D2oWfImC.js";import"./@vueuse_core@12.8.2_typescript@5.5.4-CyTP3PVf.js";import"./@vueuse_shared@12.8.2_typescript@5.5.4-B6jvMh_s.js";import"./store@2.0.12-BfN7CKDu.js";import"./mitt@3.0.1-BeZB7Ik_.js";import"./pinia@2.3.1_typescript@5.5.4_vue@3.5.18_typescript@5.5.4_-DPB-daMN.js";import"./vue-router@4.5.1_vue@3.5.18_typescript@5.5.4_-LCN95BWb.js";import"./element-plus@2.10.2_vue@3.5.18_typescript@5.5.4_-C0B857f5.js";import"./@sxzz_popperjs-es@2.11.7-CT_jBSb5.js";import"./async-validator@4.2.5-j0i5Y79Y.js";import"./memoize-one@6.0.0-BAtLgO95.js";import"./@floating-ui_dom@1.7.2-CHufsicy.js";import"./@floating-ui_core@1.7.2-DWnBSKmT.js";import"./@floating-ui_utils@0.2.10-QZXVpxRV.js";import"./vue-echarts@7.0.3_@vue_runtime-core@3.5.18_echarts@5.6.0_vue@3.5.18_typescript@5.5.4_-He2CYVXX.js";import"./echarts@5.6.0-D5a_RdwN.js";import"./tslib@2.3.0-ZseNXxlj.js";import"./zrender@5.6.1-BkMfNy7l.js";import"./axios@1.11.0-C-1G2k3o.js";import"./nprogress@0.2.0-Sg3Wh2FH.js";import"./@intlify_core-base@11.1.10-C1bgUhoS.js";import"./@intlify_shared@11.1.10-BEv--mwN.js";import"./@intlify_message-compiler@11.1.10-JI08Nz38.js";const b=n({name:"cl-select",props:{...s,modelValue:[String,Number,Array],options:{type:[Array,Object],default:()=>[]},prop:String,labelKey:{type:String,default:"label"},valueKey:{type:String,default:"value"},width:[String,Number],tree:Boolean,allLevelsId:Boolean,checkStrictly:Boolean,defaultExpandAll:Boolean,topLabel:String,current:Boolean,api:[String,Function],refreshOnChange:{type:Boolean,default:!0},refreshOnActivated:{type:Boolean,default:!0}},emits:["update:modelValue","change"],setup(s,{emit:n,expose:b}){const{refs:g,setRefs:x}=t(),{t:K}=j(),S=e(),A=l(),V=d(()=>{var e;return!A.value||"search"===(null==(e=A.value)?void 0:e.name)}),B=h(),L=c(s,"modelValue"),z=d(()=>{var e,l;let t=[];if(s.current){let a=function(e,l){var t;e.id&&e.id==(null==(t=A.value)?void 0:t.getForm("id"))&&(l=!0),l&&(e.disabled=!0),e.children&&e.children.forEach(e=>{a(e,l)})};t=i(y(null==(l=null==(e=S.value)?void 0:e["cl-table"])?void 0:l.data)),a({children:t},!1)}else t=y(B.value||s.options)||[];return s.topLabel?[{[s.labelKey]:s.topLabel,[s.valueKey]:0,children:t}]:t});function C(e){var l;const t=function(e){if(s.allLevelsId){const l=[],t=(a,r)=>{a.forEach(a=>{const i=a[s.valueKey]==e;(r||i)&&l.push(a[s.valueKey]),a.children&&t(a.children,r||i)})};return t(z.value,!1),p(l)?void 0:l}return""===e?void 0:e}(e);n("update:modelValue",t),n("change",t),V.value&&s.prop&&s.refreshOnChange&&(null==(l=S.value)||l.refresh({page:1,[s.prop]:t}))}function E(){var e;let l=null;o(s.api)&&(l=null==(e=S.value)?void 0:e.service[s.api]()),u(s.api)&&(l=s.api()),l&&l.then(e=>{B.value=r(e)})}return m(()=>{s.api&&(E(),v(()=>{var e;s.refreshOnActivated&&(A.value&&"search"!=(null==(e=A.value)?void 0:e.name)||E())}))}),b({focus:function(){var e;null==(e=g.select)||e.focus()}}),()=>{const e={width:a(s.width)},l=V.value?K("全部"):K("请选择"),t=_(f("el-tree-select"),{modelValue:L.value,"onUpdate:modelValue":e=>L.value=e,clearable:!0,filterable:!0,placeholder:l,disabled:s.disabled,data:z.value,checkStrictly:s.allLevelsId||s.checkStrictly,defaultExpandAll:s.defaultExpandAll,props:{label:s.labelKey,value:s.valueKey},style:e,onChange:C,ref:x("select")},null),r=_(f("el-select"),{modelValue:L.value,"onUpdate:modelValue":e=>L.value=e,clearable:!0,filterable:!0,disabled:s.disabled,placeholder:l,style:e,onChange:C,ref:x("select")},{default:()=>{var e;return[null==(e=z.value)?void 0:e.map(e=>o(e)?_(f("el-option"),{label:e,value:e},null):_(f("el-option"),{disabled:e.disabled,label:e[s.labelKey],value:e[s.valueKey]},null))]}});return s.tree?t:r}}});export{b as default};
